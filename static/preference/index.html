<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>偏好设置 | 开往</title>
    <link href="https://unpkg.zhimg.com/bootstrap@4.4.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://list.travellings.cn/css/style.css">
</head>

<body>
    <div class="container mt-4 mb-4">
        <div class="main p-3">
            <h3><i class="fa fa-gear"></i> 开往偏好设置</h3>
            <div class="mb-3">您可以在这里对开往进行设置，设置将保存在您的浏览器中。</div>
            <h4><i class="fa fa-tags"></i> 分类跳转</h4>
            <div class="text-muted mb-2">仅跳转到指定类型的网站（当前网站分类尚未完成，设置此项后可跳转的网站可能较少）</div>
            <select class="form-control settings" data-key="tag">
                <option value="">不使用分类跳转</option>
                <option value="blog">博客网站</option>
                <option value="normal">杂项</option>
                <option value="coder">技术类网站（博客或维基）</option>
                <option value="site">网站分享类博客</option>
                <option value="life">生活类博客</option>
                <option value="hybrid">综合类博客</option>
            </select>
            <h4><i class="fa fa-clock-o mt-3"></i> 跳转延时</h4>
            <div class="text-muted mb-2">在跳转页的停留时间，单位：毫秒</div>
            <input type="number" class="form-control settings" data-key="timeout"
                placeholder="不填写则取默认值“1500”">
            <a href="../go.html" class="btn btn-dark btn-block mt-3"><i class="fa fa-subway"></i> 设置好了，继续开往吧~</a>
        </div>
    </div>
    <script src="https://unpkg.zhimg.com/jquery@3/dist/jquery.min.js"></script>
    <script>
        const prefix = "t_preference_";
        const settings = ["tag", "timeout"];
        const getSettings = key => {
            return localStorage.getItem(prefix + key);
        }
        const removeSettings = key => {
            localStorage.removeItem(prefix + key);
        }
        const setSettings = (key, value) => {
            localStorage.setItem(prefix + key, value);
        }
        const loadSettings = () => {
            for (let setting of settings) {
                const value = getSettings(setting);
                if (!value) continue;
                $(`.settings[data-key=${setting}]`).val(value);
            }
        }
        loadSettings();
        
        $(".settings").on("input", function () {
            const key = $(this).data("key");
            const value = $(this).val();
            if (!value) {
                removeSettings(key);
            } else {
                setSettings(key, value);
            }
        });


    </script>
</body>